import requests
import re

url = input("Enter a url: ")
cookie_name = input("Enter a Cookie name: ")
pattern = input("Enter a search pattern(it can be a regex): ") # u can enter a ctf flag pattern here
wordlist_path = input("Enter path to wordlist: ")

with open(wordlist_path, "r") as wordlist_file:
    word_list = wordlist_file.read().splitlines()

# Loop through cookie values to add in each request.
for cookie_value in word_list:
    cookies = {cookie_name : cookie_value}
    response =  requests.get(url, cookies=cookies).text

    # Checks whether the response contains the pattern, case insensitive
    match = re.search(pattern, response, re.I)    
    if match:
       print(response)
       print(f"\nMatched: {match.group()}")
       print(f"The correct cookie was {cookies}")